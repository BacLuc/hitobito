-#  Copyright (c) 2012-2013, Jungwacht Blauring Schweiz. This file is part of
-#  hitobito and licensed under the Affero General Public License version 3
-#  or later. See the COPYING file at the top-level directory or at
-#  https://github.com/hitobito/hitobito.

= standard_form(:field_mappings, method: :post, url: preview_group_csv_imports_path, builder: PlainObjectFormBuilder) do |f|
  = hidden_field_tag :data, parser.to_csv

  = field_set_tag "Rolle ausw√§hlen" do
    = f.labeled :role_type, 'Rolle' do
      = select_tag(:role_type, options_from_collection_for_select(@group.possible_roles, :sti_name, :label, params[:role_type]), {class: 'span3'})
      = f.help_block 'Allen importierten Personen wird diese Rolle zugewiesen'

  = field_set_tag "Spalten zu Feldern zuordnen" do
    = f.labeled(nil, content_tag(:i, 'Spalte aus CSV')) do
      %i{style: 'line-height: 30px'} Feld in der Datenbank
    %br/
    - parser.headers.each do |column_name|
      = f.labeled(column_name, column_name) do
        = f.collection_select(column_name, fields, :key, :value, {include_blank: true, selected: guess(column_name)}, {class: 'span4'})

  = save_form_buttons(f, 'Vorschau', group_people_path(group))
